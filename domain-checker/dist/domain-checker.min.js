function _toConsumableArray(e) { return _arrayWithoutHoles(e) || _iterableToArray(e) || _unsupportedIterableToArray(e) || _nonIterableSpread() } function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") } function _unsupportedIterableToArray(e, t) { if (e) { if ("string" == typeof e) return _arrayLikeToArray(e, t); var r = Object.prototype.toString.call(e).slice(8, -1); return "Object" === r && e.constructor && (r = e.constructor.name), "Map" === r || "Set" === r ? Array.from(e) : "Arguments" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? _arrayLikeToArray(e, t) : void 0 } } function _iterableToArray(e) { if ("undefined" != typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e) } function _arrayWithoutHoles(e) { if (Array.isArray(e)) return _arrayLikeToArray(e) } function _arrayLikeToArray(e, t) { (null == t || t > e.length) && (t = e.length); for (var r = 0, n = new Array(t); r < t; r++)n[r] = e[r]; return n } function ownKeys(e, t) { var r = Object.keys(e); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); t && (n = n.filter(function (t) { return Object.getOwnPropertyDescriptor(e, t).enumerable })), r.push.apply(r, n) } return r } function _objectSpread(e) { for (var t = 1; t < arguments.length; t++) { var r = null != arguments[t] ? arguments[t] : {}; t % 2 ? ownKeys(Object(r), !0).forEach(function (t) { _defineProperty(e, t, r[t]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : ownKeys(Object(r)).forEach(function (t) { Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t)) }) } return e } function _classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function _defineProperties(e, t) { for (var r = 0; r < t.length; r++) { var n = t[r]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } function _createClass(e, t, r) { return t && _defineProperties(e.prototype, t), r && _defineProperties(e, r), e } function _defineProperty(e, t, r) { return t in e ? Object.defineProperty(e, t, { value: r, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = r, e } function _classPrivateMethodGet(e, t, r) { if (!t.has(e)) throw new TypeError("attempted to get private field on non-instance"); return r } var getTemplate = function (e) { var t = e.title, r = e.url, n = void 0 !== r && r; return '\n    <form action="POST" data-dc="form" class="domain-checker__form">\n    <fieldset class="domain-checker__fiedlset">\n      <legend class="domain-checker__legend">'.concat(null != t ? t : "Domain checker API REG.RU", '</legend>\n      <p class="domain-checker__row">\n        <label class="domain-checker__label">Domain list</label>\n        <textarea\n          data-dc="form-control"\n          class="domain-checker__form-control--textarea domain-checker__form-control"\n          name="domains"\n          placeholder="Enter domains"\n        ></textarea>\n      </p>\n      \n      ').concat(n ? "" : '\n        <p class="domain-checker__row">\n          <label class="domain-checker__label">Username</label>\n          <input\n            data-dc="form-control"\n            class="domain-checker__form-control"\n            type="text"\n            name="username"\n            placeholder="Enter username"\n          />\n        </p>\n\n        <p class="domain-checker__row">\n          <label class="domain-checker__label">Password</label>\n          <input\n            data-dc="form-control"\n            class="domain-checker__form-control"\n            type="password"\n            name="password"\n            placeholder="Password"\n          />\n        </p>\n        ', '\n      \n      <button data-dc="btn-submit" class="domain-checker__btn" disabled>Submit</button>\n    </fieldset>\n  </form>\n  <p data-dc="result" class="domain-checker__result"></p>\n  ') }, getPostData = function (e) { var t = []; for (var r in e) e.hasOwnProperty(r) && t.push(r + "=" + e[r]); return t.join("&") }, _render = new WeakSet, _setup = new WeakSet, DomainChecker = function () { function e(t, r) { var n = this; _classCallCheck(this, e), _setup.add(this), _render.add(this), _defineProperty(this, "submitHandler", function (e) { e.preventDefault(), n.postRequest() }), _defineProperty(this, "blurHandler", function () { (n.$formControls.length > 1 ? n.$form.domains.value && n.$form.username.value && n.$form.password.value : Bool(n.$form.domains.value)) ? n.$button.removeAttribute("disabled") : n.$button.setAttribute("disabled", "") }), this.$el = "string" == typeof t ? document.querySelector(t) : t, this.options = r, _classPrivateMethodGet(this, _render, _render2).call(this), _classPrivateMethodGet(this, _setup, _setup2).call(this) } return _createClass(e, [{ key: "loginDetails", get: function () { return this.options.url ? {} : { username: this.$form.username.value, password: this.$form.password.value } } }, { key: "display", value: function (e) { var t = e.result, r = e.error_text, n = e.answer; if ("error" === t) return this.$resultOutput.textContent = r, !1; var o = n.domains.map(function (e) { return "error" === e.result ? "<b>".concat(e.dname, "</b> - ").concat(e.error_text, ";<br/>") : e.price ? "<b>".concat(e.dname, "</b> - ").concat(e.result, " (Стоимость в ").concat(e.currency, " - ").concat(e.price, ", ").concat(e.is_premium ? "премиум" : "", ");<br/>") : "<b>".concat(e.dname, "</b> - ").concat(e.result, ";<br/>") }); this.$resultOutput.innerHTML = o.join("") } }, { key: "postRequest", value: function () { var e = this, t = new XMLHttpRequest, r = this.options.url, n = this.$form.domains.value.replace(/\s/g, "").split(";").map(function (e) { return { dname: e } }), o = _objectSpread({ input_format: "json", output_format: "json", io_encoding: "utf8", input_data: JSON.stringify(_objectSpread({ domains: _toConsumableArray(n) }, this.loginDetails)), show_input_params: 0 }, this.loginDetails); t.open("POST", null != r ? r : "https://api.reg.ru/api/regru2/domain/check"), t.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), t.onreadystatechange = function () { 4 === t.readyState && e.display(JSON.parse(t.responseText)) }, t.send(getPostData(o)) } }, { key: "destroy", value: function () { var e = this; this.$form.removeEventListener("submit", this.submitHandler), this.$formControls.forEach(function (t) { t.removeEventListener("blur", e.blurHandler) }) } }]), e }(); function _render2() { this.$el.classList.add("domain-checker"), this.$el.innerHTML = getTemplate(this.options) } function _setup2() { var e = this; this.$form = this.$el.querySelector('[data-dc="form"]'), this.$form.addEventListener("submit", this.submitHandler), this.$resultOutput = this.$el.querySelector('[data-dc="result"]'), this.$button = this.$form.querySelector('[data-dc="btn-submit"'), this.$formControls = this.$form.querySelectorAll('[data-dc="form-control"]'), this.$formControls.forEach(function (t) { t.addEventListener("blur", e.blurHandler) }) }